{% extends "base.html" %}
{% set active = 'config' %}
{% block content %}
<div class="row g-3">
    <!-- Strategy Settings -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-sliders"></i> Strategy Settings</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label">Minimum Spread Threshold (%)</label>
                    <input type="range" id="minSpread" class="form-range" min="0.1" max="2.0" step="0.1" value="{{ config.strategy.min_spread|default(0.5) }}">
                    <div class="d-flex justify-content-between">
                        <small class="text-muted">0.1%</small>
                        <strong id="minSpreadVal">{{ config.strategy.min_spread|default(0.5) }}%</strong>
                        <small class="text-muted">2.0%</small>
                    </div>
                    <small class="text-muted">Only trade when spread exceeds this threshold</small>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Trading Fee per Side (%)</label>
                    <input type="number" id="feeRate" class="form-control bg-dark text-light border-secondary" value="{{ config.strategy.fee_rate|default(0.1) }}" step="0.01">
                    <small class="text-muted">Exchange trading fee (0.1% = 0.001)</small>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Slippage Estimate (%)</label>
                    <input type="number" id="slippage" class="form-control bg-dark text-light border-secondary" value="{{ config.strategy.slippage|default(0.05) }}" step="0.01">
                    <small class="text-muted">Expected price slippage per trade</small>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Strategy Type</label>
                    <select class="form-select bg-dark text-light border-secondary">
                        <option value="arbitrage" {% if config.strategy.type == 'arbitrage' %}selected{% endif %}>Cross-Exchange Arbitrage</option>
                        <option value="triangular" {% if config.strategy.type == 'triangular' %}selected{% endif %}>Triangular Arbitrage</option>
                        <option value="dca" {% if config.strategy.type == 'dca' %}selected{% endif %}>DCA (Dollar Cost Average)</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Risk Management -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-shield-check"></i> Risk Management</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label">Max Position Size (BTC)</label>
                    <input type="number" id="maxPos" class="form-control bg-dark text-light border-secondary" value="{{ config.risk.max_position_btc|default(0.02) }}" step="0.001">
                    <small class="text-muted">Maximum amount per trade</small>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Stop Loss (%)</label>
                    <input type="range" id="stopLoss" class="form-range" min="0.5" max="10.0" step="0.5" value="{{ config.risk.stop_loss_pct|default(2.0) }}">
                    <div class="d-flex justify-content-between">
                        <small class="text-muted">0.5%</small>
                        <strong id="stopLossVal">{{ config.risk.stop_loss_pct|default(2.0) }}%</strong>
                        <small class="text-muted">10%</small>
                    </div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Capital per Trade (%)</label>
                    <input type="number" id="capitalPct" class="form-control bg-dark text-light border-secondary" value="{{ config.risk.capital_pct_per_trade|default(5) }}" step="1">
                    <small class="text-muted">Percentage of balance per trade</small>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Daily Loss Limit (%)</label>
                    <input type="number" id="dailyLoss" class="form-control bg-dark text-light border-secondary" value="{{ config.risk.daily_loss_limit_pct|default(5) }}" step="1">
                    <small class="text-muted">Stop trading after this daily loss</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bot Settings -->
<div class="card mt-3">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-gear"></i> Bot Configuration</h5>
    </div>
    <div class="card-body">
        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Monitor Interval (seconds)</label>
                <input type="number" class="form-control bg-dark text-light border-secondary" value="{{ config.bot.monitor_interval|default(60) }}">
            </div>
            <div class="col-md-4">
                <label class="form-label">Log Level</label>
                <select class="form-select bg-dark text-light border-secondary">
                    <option value="DEBUG">DEBUG</option>
                    <option value="INFO" selected>INFO</option>
                    <option value="WARNING">WARNING</option>
                    <option value="ERROR">ERROR</option>
                </select>
            </div>
            <div class="col-md-4">
                <label class="form-label">Dashboard Port</label>
                <input type="number" class="form-control bg-dark text-light border-secondary" value="{{ config.dashboard.port|default(8080) }}">
            </div>
        </div>
        
        <div class="mt-4">
            <button onclick="saveConfig()" class="btn btn-success">
                <i class="bi bi-save"></i> Save Configuration
            </button>
            <button onclick="location.reload()" class="btn btn-outline-light ms-2">
                <i class="bi bi-arrow-counterclockwise"></i> Reset
            </button>
        </div>
    </div>
</div>

<script>
document.getElementById('minSpread').addEventListener('input', function() {
    document.getElementById('minSpreadVal').textContent = this.value + '%';
});
document.getElementById('stopLoss').addEventListener('input', function() {
    document.getElementById('stopLossVal').textContent = this.value + '%';
});
</script>
{% endblock %}
