{% extends "base.html" %}
{% block content %}
<div class="container-fluid">
    <h2 class="mb-3"><i class="bi bi-sliders"></i> Configuration</h2>
    
    <div class="card">
        <div class="card-header">Bot Settings</div>
        <div class="card-body">
            <form id="configForm">
                <div class="mb-3">
                    <label class="form-label">Trading Mode</label>
                    <select class="form-select bg-dark text-light" name="mode">
                        <option value="PAPER" {{ 'selected' if data.mode == 'PAPER' }}>PAPER (Safe)</option>
                        <option value="LIVE" {{ 'selected' if data.mode == 'LIVE' }}>LIVE (Real Money)</option>
                    </select>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Min Spread %</label>
                    <input type="number" step="0.01" class="form-control bg-dark text-light" name="min_spread" value="0.1">
                    <div class="form-text">Minimum spread to trigger trade</div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Max Position Size (USDT)</label>
                    <input type="number" class="form-control bg-dark text-light" name="max_position" value="10">
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Stop Loss %</label>
                    <input type="number" step="0.1" class="form-control bg-dark text-light" name="stop_loss" value="2.0">
                </div>
                
                <button type="submit" class="btn btn-success">
                    <i class="bi bi-save"></i> Save Config
                </button>
            </form>
        </div>
    </div>

    <div class="card mt-3">
        <div class="card-header">Current Config (JSON)</div>
        <div class="card-body">
            <pre class="bg-black p-3 rounded"><code>{{ data.config | tojson(indent=2) }}</code></pre>
        </div>
    </div>
</div>

<script>
document.getElementById('configForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    const config = {
        mode: formData.get('mode'),
        min_spread: parseFloat(formData.get('min_spread')),
        max_position: parseFloat(formData.get('max_position')),
        stop_loss: parseFloat(formData.get('stop_loss'))
    };
    
    fetch('/config', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(config)
    })
    .then(r => r.json())
    .then(data => alert(data.status || 'Saved!'));
});
</script>
{% endblock %}
